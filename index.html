<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MyProject - 首页</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <nav>
      <h1><a href="/">飞鸟的sbox</a></h1>
      <!-- 搜索框 -->
      <div class="search-container">
        <input type="text" id="search-input" placeholder="搜索文档、教程..." />
        <button onclick="performSearch()">🔍</button>
      </div>
      <ul>
        <li><a href="docs/">API 文档</a></li>
        <li><a href="tutorials/">新手教程</a></li>
      </ul>
    </nav>
  </header>

  <main class="hero">
    <h2>飞鸟的sbox</h2>
    <p>记录我关于sbox学习</p>
    
    <div class="quick-links">
      <a href="docs/index.html">查看 API 文档 →</a>
      <a href="tutorials/index.html">开始新手教程 →</a>
    </div>
  </main>

  // 添加教程列表区域
  <section class="tutorial-section">
    <div class="tutorial-index">
      <h2>最新教程</h2>
      <ul id="markdown-files-list" class="tutorial-list">
        <li class="loading">正在加载教程列表...</li>
      </ul>
    </div>
  </section>

  <script src="js/search.js"></script>
  // 添加获取Markdown文件列表的脚本
  <script>
    // 页面加载完成后获取 Markdown 文件列表
    document.addEventListener('DOMContentLoaded', function() {
      loadMarkdownFiles();
    });

    function loadMarkdownFiles() {
      const fileListElement = document.getElementById('markdown-files-list');
      
      // 使用 fetch API 获取 Markdown 文件列表
      fetch('tutorials/Markdown/')
        .then(response => {
          if (!response.ok) {
            throw new Error('网络响应错误');
          }
          return response.text();
        })
        .then(html => {
          // 解析返回的 HTML 内容，提取 Markdown 文件链接
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          const links = doc.querySelectorAll('a');
          
          const markdownFiles = [];
          links.forEach(link => {
            const href = link.getAttribute('href');
            if (href && (href.endsWith('.md') || href.endsWith('.markdown'))) {
              markdownFiles.push({
                name: href,
                url: 'tutorials/Markdown/' + href
              });
            }
          });
          
          displayMarkdownFiles(markdownFiles);
        })
        .catch(error => {
          console.error('获取文件列表失败:', error);
          fileListElement.innerHTML = `<li class="error">加载教程列表失败: ${error.message}</li>`;
        });
    }
    
    function displayMarkdownFiles(files) {
      const fileListElement = document.getElementById('markdown-files-list');
      
      if (files.length > 0) {
        const fileListHTML = files.map(file => 
          `<li><a href="${file.url}" target="_blank">${decodeURIComponent(file.name)}</a></li>`
        ).join('');
        
        fileListElement.innerHTML = fileListHTML;
      } else {
        fileListElement.innerHTML = '<li>暂无教程文件</li>';
      }
    }
  </script>
</body>
</html>